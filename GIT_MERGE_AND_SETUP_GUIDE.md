# Project Setup Guide for Auth.js v5 (CMD for Windows)

This guide provides step-by-step CMD commands to set up your local project with the new Auth.js v5 refactor branch, clean your project environment, and initialize the database. Please run these from the root directory of your project (e.g., `C:\Users\YourUser\Desktop\100-network-updated-feature-initial-functionality-setup>`).

**IMPORTANT:** If any command results in an error or unexpected output, please copy the command and its full output and share it with the AI assistant before proceeding.

## Step 1: Commit Any Local Changes (Optional but Recommended)
If you have any uncommitted local changes you want to save, commit them to your current branch:
```cmd
git add .
git commit -m "chore: Stashing local changes before checkout"
```
*(If it says "nothing to commit", that's okay.)*

## Step 2: Fetch Latest from Remote and Checkout the New Auth.js v5 Branch
This ensures your local git repository knows about all branches from the remote. Then, you'll check out the specific branch containing the Auth.js v5 setup.
**The branch name for this setup is: `feature/auth-v5-final-setup`**

```cmd
git fetch origin
git checkout feature/auth-v5-final-setup
```
If you are already on a branch with these changes and just pulling updates:
```cmd
git pull origin feature/auth-v5-final-setup
```
You should see output indicating you've switched to or updated the new branch.

## Step 3: Clean Up Database and Migrations
To ensure a fresh start for the database schema with the new branch's settings:
*   Delete the SQLite database file (if it exists):
    ```cmd
    del prisma\dev.db
    ```
    *(If it says "Could Not Find," that's okay).*
*   Remove the existing migrations folder completely (if it exists):
    ```cmd
    rd /s /q prisma\migrations
    ```

## Step 4: Clean Up `node_modules`, `.next` Folder, and Lockfile
This ensures a completely clean build and dependency installation based on the new branch's `package.json`.
```cmd
rd /s /q node_modules
```
Then:
```cmd
rd /s /q .next
```
Then:
```cmd
del pnpm-lock.yaml
```
*(If any of these `del` or `rd` commands say "Could Not Find" or "The system cannot find the file specified," that's okay, it just means those items weren't present.)*

## Step 5: Perform a Clean Install of All Dependencies
This will install all packages based on the `package.json` from the `feature/auth-v5-final-setup` branch. This is crucial as dependencies like `next-auth` have changed.
```cmd
pnpm install
```
- Review the output. You may see peer dependency warnings (e.g., for React 19 with some UI libraries) â€“ this is generally okay for now. Ensure there are no critical `ERESOLVE` errors for packages like `next-auth` or `@auth/prisma-adapter`.

## Step 6: Verify Environment Variables
Ensure your `.env` file (in the project root) has the following, replacing the placeholder for `AUTH_SECRET` with a strong, random string (e.g., generated by `openssl rand -base64 32`):
```
DATABASE_URL="file:./dev.db"
AUTH_SECRET="YOUR_STRONG_RANDOM_SECRET_HERE_PLEASE_REPLACE"
AUTH_URL="http://localhost:3000"
# NEXTAUTH_URL="http://localhost:3000" (Can be kept for compatibility or removed if AUTH_URL is primary)
```

## Step 7: Run Prisma Migration
This command will create your database schema based on `prisma/schema.prisma` from the new branch (this schema should *not* yet include the `Like` model changes) and generate the Prisma client:
```cmd
npx prisma migrate dev --name initial_schema_with_auth_v5
```
- This command should complete successfully, creating `prisma/dev.db` and a new migration file in `prisma/migrations/`.

## Step 8: Test the Development Server
Now, try to run the development server:
```cmd
pnpm run dev
```
**Observe the terminal output carefully:**
- Does the server start successfully?
- **Is the "React Context is unavailable in Server Components" error GONE?**

**If the server starts without the context error:**
- Open `http://localhost:3000` in your browser. You should see the minimal home page.
- Test basic authentication:
    - Navigate to `/auth/signup` and try to register a new user.
    - Navigate to `/auth/login` and try to log in with the new user.
    - Does login redirect you (e.g., to `/feed`)?
    - Note: The main header UI in `app/layout.tsx` is currently configured with `HeaderWrapper` commented out for initial testing.

After completing all these steps, please inform the AI assistant of the outcome of each major step (especially `git checkout`, `pnpm install`, `npx prisma migrate dev`, and `pnpm run dev`, including any errors encountered). This will determine the next steps, such as restoring the full UI for `app/page.tsx` and `app/layout.tsx`, and then proceeding with the `Like` model migration.
